name: CodeNarc Linter

on: [push, pull_request]

jobs:
  codenarc:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Java
        uses: actions/setup-java@v4
        with:
          distribution: "temurin"
          java-version: "17"

      - name: Download CodeNarc
        run: |
          mkdir libs
          wget https://github.com/CodeNarc/CodeNarc/releases/download/v3.6.0/CodeNarc-3.6.0-groovy-4.0.jar -O codenarc.jar
          wget https://repo1.maven.org/maven2/org/apache/groovy/groovy/4.0.21/groovy-4.0.21.jar -O libs/groovy.jar

      - name: Run CodeNarc on groovy.txt
        run: |
          java -cp codenarc.jar org.codenarc.CodeNarc \
            -rulesetfiles=codenarc.groovy \
            -includes=groovy.txt \
            -report=text:stdout
